(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{4298:function(e,s,a){Promise.resolve().then(a.bind(a,8681))},8681:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return l}});var t=a(7437),r=a(2265),n=a(9376),i=a(970);function l(){let[e,s]=(0,r.useState)({totalUsers:0,totalAccounts:0,totalBalance:0,totalTransactions:0,recentUsers:[],recentTransactions:[]}),[a,l]=(0,r.useState)(!0),c=(0,n.useRouter)(),d=(0,r.useCallback)(async()=>{let{data:{user:e}}=await (0,i.D)().auth.getUser();if(!e){c.push("/admin/login");return}let{data:s}=await (0,i.D)().from("profiles").select("role").eq("user_id",e.id).single();s&&"admin"===s.role||c.push("/admin/login")},[c]);async function o(){try{let[e,a,t]=await Promise.all([(0,i.D)().from("profiles").select("*",{count:"exact"}),(0,i.D)().from("accounts").select("*, profiles!inner(first_name, last_name, email)",{count:"exact"}),(0,i.D)().from("transactions").select("*",{count:"exact"})]),{data:r}=await (0,i.D)().from("accounts").select("available_balance"),n=(null==r?void 0:r.reduce((e,s)=>e+(Number(s.available_balance)||0),0))||0,{data:l}=await (0,i.D)().from("profiles").select("*, accounts!left(account_number, available_balance)").order("created_at",{ascending:!1}).limit(10),{data:c}=await (0,i.D)().from("transactions").select("*, profiles!inner(first_name, last_name)").order("created_at",{ascending:!1}).limit(10);s({totalUsers:e.count||0,totalAccounts:a.count||0,totalBalance:n,totalTransactions:t.count||0,recentUsers:l||[],recentTransactions:c||[]})}catch(e){console.error("Error loading dashboard data:",e)}finally{l(!1)}}function m(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}return((0,r.useEffect)(()=>{d(),o()},[d]),a)?(0,t.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading admin dashboard..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,t.jsxs)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,t.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,t.jsx)("div",{className:"p-5",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),(0,t.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,t.jsxs)("dl",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Users"}),(0,t.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:e.totalUsers.toLocaleString()})]})})]})})}),(0,t.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,t.jsx)("div",{className:"p-5",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),(0,t.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,t.jsxs)("dl",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Accounts"}),(0,t.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:e.totalAccounts.toLocaleString()})]})})]})})}),(0,t.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,t.jsx)("div",{className:"p-5",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),(0,t.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,t.jsxs)("dl",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Balance"}),(0,t.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:m(e.totalBalance)})]})})]})})}),(0,t.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,t.jsx)("div",{className:"p-5",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v4a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,t.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,t.jsxs)("dl",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Transactions"}),(0,t.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:e.totalTransactions.toLocaleString()})]})})]})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Users"})}),(0,t.jsx)("div",{className:"overflow-hidden",children:(0,t.jsx)("ul",{className:"divide-y divide-gray-200",children:e.recentUsers.map(e=>{var s;return(0,t.jsx)("li",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:(null===(s=e.accounts)||void 0===s?void 0:s[0])?m(Number(e.accounts[0].available_balance)||0):"No account"}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString()})]})]})},e.id)})})})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Transactions"})}),(0,t.jsx)("div",{className:"overflow-hidden",children:(0,t.jsx)("ul",{className:"divide-y divide-gray-200",children:e.recentTransactions.map(e=>{var s,a;return(0,t.jsx)("li",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[null===(s=e.profiles)||void 0===s?void 0:s.first_name," ",null===(a=e.profiles)||void 0===a?void 0:a.last_name]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[e.type," â€¢ ",e.status]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"text-sm font-medium ".concat("debit"===e.type?"text-red-600":"text-green-600"),children:["debit"===e.type?"-":"+",m(Number(e.amount)||0)]}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString()})]})]})},e.id)})})})]})]})]})})}},970:function(e,s,a){"use strict";a.d(s,{D:function(){return i}});var t=a(1388),r=a(257);let n=null;function i(){var e,s;if(n)return n;let a=null!==(s=null!==(e=r.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY)&&void 0!==e?e:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpaWhyb2dxdGlxaGJ3dW5xeGphIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxODIyMzgsImV4cCI6MjA3MDc1ODIzOH0.o4o1p3P0a0Kwnmj3TpUNmOtQb2J_p_bV1vhCksc-TKo")&&void 0!==s?s:"",i=e=>e.trim().replace(/^['"]+|['"]+$/g,""),l=i("https://ciihrogqtiqhbwunqxja.supabase.co"),c=i(a);if(!l||!c)throw Error("Supabase env vars missing.");return n=(0,t.createBrowserClient)(l,c)}},9376:function(e,s,a){"use strict";var t=a(5475);a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[388,971,117,744],function(){return e(e.s=4298)}),_N_E=e.O()}]);