(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{6109:function(e,t,s){Promise.resolve().then(s.bind(s,3499))},3499:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var a=s(7437),r=s(2265),n=s(9376),i=s(970);function l(){var e,t;let[s,l]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[o,u]=(0,r.useState)(""),[x,m]=(0,r.useState)("all"),[p,h]=(0,r.useState)("all"),[g,f]=(0,r.useState)(null),[y,v]=(0,r.useState)(!1),b=(0,n.useRouter)(),j=(0,r.useCallback)(async()=>{let{data:{user:e}}=await (0,i.D)().auth.getUser();if(!e){b.push("/admin/login");return}},[b]);async function w(){try{let{data:e,error:t}=await (0,i.D)().from("transactions").select("\n          *,\n          profiles!inner (\n            first_name,\n            last_name,\n            email\n          ),\n          accounts!inner (\n            account_number\n          )\n        ").order("created_at",{ascending:!1});if(t)throw t;l(e||[])}catch(e){console.error("Error loading transactions:",e)}finally{d(!1)}}async function N(e,t){try{let{error:s}=await (0,i.D)().from("transactions").update({status:t}).eq("id",e);if(s)throw s;await w(),v(!1),f(null)}catch(e){console.error("Error updating transaction:",e),alert("Failed to update transaction")}}async function C(e){if(confirm("Are you sure you want to delete this transaction? This action cannot be undone."))try{let{error:t}=await (0,i.D)().from("transactions").delete().eq("id",e);if(t)throw t;await w()}catch(e){console.error("Error deleting transaction:",e),alert("Failed to delete transaction")}}(0,r.useEffect)(()=>{j(),w()},[j]);let _=s.filter(e=>{var t,s,a,r,n,i,l;let c=(null===(t=e.profiles)||void 0===t?void 0:t.email.toLowerCase().includes(o.toLowerCase()))||(null===(a=e.profiles)||void 0===a?void 0:null===(s=a.first_name)||void 0===s?void 0:s.toLowerCase().includes(o.toLowerCase()))||(null===(n=e.profiles)||void 0===n?void 0:null===(r=n.last_name)||void 0===r?void 0:r.toLowerCase().includes(o.toLowerCase()))||(null===(i=e.accounts)||void 0===i?void 0:i.account_number.toLowerCase().includes(o.toLowerCase()))||e.description.toLowerCase().includes(o.toLowerCase()),d=null!==(l=e.status)&&void 0!==l?l:"pending",u="all"===x||d===x,m="all"===p||e.type===p;return c&&u&&m});function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(e)}function k(e){switch(e){case"credit":return"text-green-600";case"debit":return"text-red-600";default:return"text-gray-600"}}return c?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading transactions..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"flex justify-between items-center h-16",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("a",{href:"/admin/dashboard",className:"text-blue-600 hover:text-blue-800 mr-4",children:"← Dashboard"}),(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Transaction Management"})]})})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",placeholder:"Search by user, account number, or description...",value:o,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{"aria-label":"Filter transactions by status",value:x,onChange:e=>m(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"failed",children:"Failed"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{"aria-label":"Filter transactions by type",value:p,onChange:e=>h(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Types"}),(0,a.jsx)("option",{value:"credit",children:"Credit"}),(0,a.jsx)("option",{value:"debit",children:"Debit"})]})})]})}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Transactions (",_.length,")"]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map(e=>{var t,s,r,n,i,l;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[new Date(e.created_at).toLocaleDateString(),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleTimeString()})]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[null===(t=e.profiles)||void 0===t?void 0:t.first_name," ",null===(s=e.profiles)||void 0===s?void 0:s.last_name]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:null===(r=e.profiles)||void 0===r?void 0:r.email})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:null===(n=e.accounts)||void 0===n?void 0:n.account_number}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"text-sm font-medium ".concat(k(e.type)),children:e.type.toUpperCase()})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("span",{className:k(e.type),children:["debit"===e.type?"-":"+",S(Number(e.amount),e.currency)]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(function(e){switch(e){case"completed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}(null!==(i=e.status)&&void 0!==i?i:"pending")),children:null!==(l=e.status)&&void 0!==l?l:"pending"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:e.description}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{f(e),v(!0)},className:"text-blue-600 hover:text-blue-900",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>C(e.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})})]},e.id)})})]})})]})]}),y&&g&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Transaction"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,a.jsxs)("select",{"aria-label":"Edit transaction status",defaultValue:g.status,onChange:e=>N(g.id,e.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",children:[(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"failed",children:"Failed"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Transaction Details"}),(0,a.jsxs)("div",{className:"mt-1 text-sm text-gray-600 space-y-1",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"User:"})," ",null===(e=g.profiles)||void 0===e?void 0:e.first_name," ",null===(t=g.profiles)||void 0===t?void 0:t.last_name]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Amount:"})," ",S(Number(g.amount),g.currency)]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Type:"})," ",g.type]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Description:"})," ",g.description]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Date:"})," ",new Date(g.created_at).toLocaleString()]})]})]})]}),(0,a.jsx)("div",{className:"flex justify-end space-x-3 mt-6",children:(0,a.jsx)("button",{onClick:()=>{v(!1),f(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"})})]})})})]})}},970:function(e,t,s){"use strict";s.d(t,{D:function(){return i}});var a=s(1388),r=s(257);let n=null;function i(){var e,t;if(n)return n;let s=null!==(t=null!==(e=r.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY)&&void 0!==e?e:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpaWhyb2dxdGlxaGJ3dW5xeGphIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxODIyMzgsImV4cCI6MjA3MDc1ODIzOH0.o4o1p3P0a0Kwnmj3TpUNmOtQb2J_p_bV1vhCksc-TKo")&&void 0!==t?t:"",i=e=>e.trim().replace(/^['"]+|['"]+$/g,""),l=i("https://ciihrogqtiqhbwunqxja.supabase.co"),c=i(s);if(!l||!c)throw Error("Supabase env vars missing.");return n=(0,a.createBrowserClient)(l,c)}},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[388,971,117,744],function(){return e(e.s=6109)}),_N_E=e.O()}]);