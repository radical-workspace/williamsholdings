(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[443],{1729:function(e,t,s){Promise.resolve().then(s.bind(s,9802))},9802:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var i=s(7437),n=s(2265),r=s(970),a=s(8989);function c(){let[e,t]=(0,n.useState)(""),[s,c]=(0,n.useState)(""),[l,u]=(0,n.useState)(!1);async function d(t){if(t.preventDefault(),!/^\d{6}$/.test(e)){c("PIN must be 6 digits");return}u(!0),c("Verifying PIN...");try{let t=(0,r.D)(),{data:{user:s},error:i}=await t.auth.getUser();if(i||!s){c("Authentication error: ".concat((null==i?void 0:i.message)||"Not signed in")),u(!1);return}c("User authenticated. Checking PIN...");let{data:n,error:l}=await t.from("profiles").select("pin_hash").eq("user_id",s.id).single();if(l){"PGRST116"===l.code?c("❌ PIN not set. Please set up your PIN first."):c("Profile error: ".concat(l.message)),u(!1);return}if(!(null==n?void 0:n.pin_hash)){c("❌ PIN not set. Please set up your PIN first."),u(!1);return}let d=a.createHash("sha256").update("salt"+e).digest("hex");n.pin_hash===d?(c("✅ PIN verified successfully! Redirecting to dashboard..."),localStorage.setItem("pin_verified","true"),localStorage.setItem("pin_verified_at",Date.now().toString()),setTimeout(()=>{window.location.href="/dashboard"},1500)):c("❌ Incorrect PIN. Please try again.")}catch(e){c("Unexpected error: ".concat(e))}finally{u(!1)}}return(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,i.jsxs)("div",{className:"w-full max-w-sm space-y-4 card",children:[(0,i.jsx)("h1",{className:"text-xl font-semibold text-center",children:"Enter PIN (Client-Side)"}),(0,i.jsxs)("form",{onSubmit:d,className:"space-y-3",children:[(0,i.jsx)("input",{className:"input",inputMode:"numeric",maxLength:6,value:e,onChange:e=>t(e.target.value.replace(/\D/g,"")),placeholder:"6-digit PIN",required:!0}),s&&(0,i.jsx)("div",{className:"text-sm p-2 rounded ".concat(s.includes("✅")?"bg-green-100 text-green-700":s.includes("❌")?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"),children:s}),(0,i.jsx)("button",{className:"btn btn-primary w-full",disabled:l,children:l?"Verifying...":"Verify PIN"})]}),(0,i.jsxs)("div",{className:"text-center space-y-2",children:[(0,i.jsxs)("div",{className:"text-sm text-slate-600",children:["No PIN yet? ",(0,i.jsx)("a",{href:"/auth/pin-setup-client",className:"underline",children:"Set it up"})]}),(0,i.jsxs)("div",{className:"space-x-2 text-sm",children:[(0,i.jsx)("a",{href:"/auth/debug",className:"text-blue-600 underline",children:"Debug Page"}),(0,i.jsx)("a",{href:"/auth/test",className:"text-blue-600 underline",children:"Test Page"})]})]})]})})}},970:function(e,t,s){"use strict";s.d(t,{D:function(){return a}});var i=s(1388),n=s(257);let r=null;function a(){var e,t;if(r)return r;let s=null!==(t=null!==(e=n.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY)&&void 0!==e?e:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpaWhyb2dxdGlxaGJ3dW5xeGphIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxODIyMzgsImV4cCI6MjA3MDc1ODIzOH0.o4o1p3P0a0Kwnmj3TpUNmOtQb2J_p_bV1vhCksc-TKo")&&void 0!==t?t:"",a=e=>e.trim().replace(/^['"]+|['"]+$/g,""),c=a("https://ciihrogqtiqhbwunqxja.supabase.co"),l=a(s);if(!c||!l)throw Error("Supabase env vars missing.");return r=(0,i.createBrowserClient)(c,l)}}},function(e){e.O(0,[218,388,123,971,117,744],function(){return e(e.s=1729)}),_N_E=e.O()}]);